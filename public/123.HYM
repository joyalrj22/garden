<!doctype html>

<html lang="en">

  <head>
  
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	
	<link rel="stylesheet" href="css/garden_theme.css">
	<link rel="stylesheet" href="css/logincss.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
    <title>St Cuthberts Gardening Society</title>
  </head>
  
  <body>
	
	<nav role="navigation" class="navbar navbar-expand-sm bg-light navbar-light sticky-top">
		<div class="col-8">
			<a class="navbar-brand" href="#">
				<img class="img-responsive" src="Images/logo-cutout.jpg" alt="Cuths Gardening Society" style="width:40px;"></img>
			</a>
			<button id="openLogin" class="fas fa-lock" href="#popUpLogin" rel="modal:open"></button>
		</div>
		<div class="col-4">
			<a class="nav-link" id="events" href="#eventsContent" data-toggle="tab">Events</a>
			<a class="nav nav-link" id="blog" href="#blogContent" data-toggle="tab">Blog</a>
			<a class="nav-link" id="photo" href="#photoContent" data-toggle="tab">Photos</a>
			<a class="nav nav-link" id="about" href="#aboutContent" data-toggle="tab">About</a>
		</div>
	</nav>
	
	<div class="tab-content">
		<div id="homeContent" class="content">
		
			<div class="jumbotron jumbotron-fluid">
			
				<div class="container-fluid">
					<h1 class="display-4">St Cuthberts Gardening Society</h1>
					<br>
					<blockquote class="blockquote">
						<h6>Gardens are not made by singing ‘Oh, how beautiful,’ and sitting in the shade.
						<br><small>~ Rudyard Kipling</small></h6>
					</blockquote>
				</div>
			</div>
			
			<div id="slideshow" class="carousel slide" data-ride="carousel">
			
				<ul class="carousel-indicators">
					<li data-target="#slideshow" data-slide-to="0" class="active"></li>
					<li data-target="#slideshow" data-slide-to="1"></li>
					<li data-target="#slideshow" data-slide-to="2"></li>
				</ul>
				
				<div class="carousel-inner" role="listbox">
					<div class="carousel-item active" role="option">
						<div class="img1"> </div>
					
					</div>
					
					<div class="carousel-item" role="option">
						<div class="img2"> </div>
					</div>
					
					</div>
				</div>
			
				<!-- Left and right controls -->
				<a class="carousel-control-prev" href="#slideshow" data-slide="prev">
					<span class="carousel-control-prev-icon"></span>
				</a>
				<a class="carousel-control-next" href="#slideshow" data-slide="next">
					<span class="carousel-control-next-icon"></span>
				</a>
			</div>	
				
		
		<div id="aboutContent" class = "content">about
		</div>
		
		<div id="blogContent" class = "content flex-grid">
			<div class="diary col">
				<div class="card-header">Date</div>
				<div class="card-body">
					<h5 class="card-title">Title</h5>
					<p class="card-text">What was done</p>
				</div>
			</div>	
			<div class="container col comments">
					<div  id="logout">
						<div class="comment-tabs">          
							<div class="comment-tab">
								<div class="tab-pane active" id="comments-logout">                
									<ul class="media-list">
									   
									</ul> 
								</div>
								<div class="tab-pane" id="add-comment">
									<form action="#" method="post" class="form-horizontal" id="commentForm" role="form"> 
										<div class="form-group">
											  <input class="form-control" name="addComment" id="addComment" rows="5"></input>
											</div>
										</div>
										
										<div class="form-group">
											<div class="col-sm-offset-2 col-sm-10">                    
												<button class="btn btn-success btn-circle text-uppercase" type="button" id="submitComment"><span class="glyphicon glyphicon-send"></span> Summit comment</button>
											</div>
										</div>            
									</form>
								</div>
							</div>
						</div>
					</div>
				
		</div>
		<div id="eventsContent" class = "content">
			<div class="container1">
				<div class="row">
					<div class="[ col-xs-12 col-sm-offset-2 col-sm-8 ]">
						<ul class="event-list">
							<li>
								<time datetime="2016-02-14">
									<span class="day">14</span>
									<span class="month">Feb</span>
									<span class="year">2016</span>
									<span class="time">ALL DAY</span>
								</time>
								<!-- <img alt="Independence Day" src="https://farm4.staticflickr.com/3100/2693171833_3545fb852c_q.jpg" /> -->
								<div class="info">
									<h2 class="title">The GCBC</h2>
									<p class="desc">Book of Revelation Conference begins with Dr. Charles Massegee.<br>5:00 p.m. Sunday and 7:00 p.m. Monday - Wednesday</p>
								</div>
							</li>
							<li class="event-details">
								<div class="info" style="height:auto">
									<p class="desc">This internationally-known author and conference speaker will keep you on the edge of your seat as he brings Book of REVELATION alive! </p>    
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<div id="photoContent" class = "content">photos
		</div>
    </div>
	
    <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header" style="padding:35px 50px;">
		  <h4 class="modal-title"><span class="fas fa-lock"></span> Login</h4>
          <button type="button" id="closeModal" class="close" data-dismiss="modal">&times;</button>
          
        </div>
        <div class="modal-body" style="padding:40px 50px;">
          <form id="logForm" role="form">
            <div class="form-group">
              <label for="usrname"><span class="far fa-user"></span> Username</label>
              <input type="text" class="form-control" id="usrname" name="user" placeholder="Enter email">
            </div>
            <div class="form-group">
              <label for="psw"><span class="fas fa-key"></span>Password</label>
              <input type="text" class="form-control" id="psw" name="pw" placeholder="Enter password">
            </div>
            <div class="checkbox">
              <label><input type="checkbox" value="" checked>Remember me</label>
            </div>
              <button type="button" class="btn btn-success btn-block" id="logSub"> Login</button>
          </form>
        </div>
        <div class="modal-footer">
         
          <p>Not a member? <a href="#">Sign Up</a></p>
        </div>
      </div>
      
    </div>
  </div> 
</div>
	
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script src="javascript/mustache.js" type="text/javascript"></script>
	<script id="comment-template" type="text/template">
	<script id="comment-template" type="text/template">
		
		<li class='media'>
			<img class='media-object rounded-circle' src={{{pp}}}>
				<div class='media-body'>
					<div class='well well-lg'>
						<h4 class='media-heading text-uppercase reviews'>{{name}}</h4>
						<p class='media-comment'>{{comment}}</p>
					</div>
					<p class='date'>{{date}}</p>
				</div>
		</li>
		
	</script>
	
	<script language="javascript" type="text/javascript">
		var loggedin = false;
		var adminStatus = "none";
		var username;
		
		function getComments() {
			$.get('http://127.0.0.1:8080/comments',{},
			function (data) {
				console.log(data);
				$(".media-list").empty();
				var template = $("#comment-template").html();
				for (var key in data) {
					var commentData = {};
					commentData.date = key;
					for (var user in data[key]) {
						commentData.name = user;
						commentData.comment = data[key][user][0];
						commentData.pp = "http://localhost:8080"+data[key][user][1];
						var html = Mustache.to_html(template, commentData);
						$(".media-list").append(html);
						
						
					}
					
				}
				console.log($(".media-list").children());
				$(".content").hide();
				$("#blogContent").show();
				
				if (loggedin == false){
					$("#addComment").hide();
					$("#submitComment").hide();
				}
				
				
				
			});
		}
		$("div.content").not(":eq(0)").hide();
		
		function changeTab(event){
			event.preventDefault();
			$(".content").hide();     
			
			$(event.data.pageID).show();
		}
		$(document).ready(function(){
			$("#blog").on("click",getComments);
			$("#events").on("click",{pageID:"#eventsContent"},changeTab);
			$("#photo").on("click",{pageID:"#photoContent"},changeTab);
			$("#about").on("click",{pageID:"#aboutContent"},changeTab);
			$(".navbar-brand").on("click",{pageID:"#homeContent"},changeTab);
			
			$("#openLogin").click(function(){
				$("#myModal").modal();
			});

			$("#logSub").on("click",
				function() {
					
					username = $('#usrname').val();
					
					$.ajax({
						method: "POST",
						url: 'http://127.0.01:8080/login',
						data: {formData:$("#logForm").serialize()},
						success: function(data,status){
							$("#closeModal").click();
							$("#openLogin").attr('class','fas fa-unlock');
							loggedin = true;
							adminStatus = data;
							console.log(adminStatus);
							if ($("#blogContent").is(':visible')){
								$("#addComment").show();
								$("#submitComment").show();
							}

						},
						error: function(XMLHttpRequest, textStatus, errorThrown) {
									alert("some error");
								}
					});
					
					
					
				}
			);
			
			$("#submitComment").on("click",
				function() {
					
					comment = $('#addComment').val();
				
					$.ajax({
						method: "POST",
						url: 'http://127.0.01:8080/login',
						data: {[username]:comment},
						success: getComments(),
						error: function(XMLHttpRequest, textStatus, errorThrown) {
									alert("some error");
								}
					});
					
					
				
				}
			);
		});
		
			
			
		$(window).load(function() {
			$('.event-details').css('display','none');
			$('.event-details').css('height','auto');
			$('.event-details').css('margin-top','-17px');
			$('.event-details > .info').css('height','auto');
			$('.disabled').prev().css('cursor','default');
			
			
			$('.event-list > li').click(function() {
				if (!$(this).nextAll('.event-details').first().hasClass('disabled')) {
					
					$(this).nextAll('.event-details').first().nextAll('.info').first().height('auto');
					$(this).nextAll('.event-details').first().slideToggle();
				}
				});
		});
		
		
	</script>
		
  </body>
  
</html>